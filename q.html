<template>
   <canvas id="myChart"></canvas>
</template>

<script setup>
   import Chart from "chart.js/auto";
   import "chartjs-adapter-date-fns";

   const chartData = {
      datasets: [
         {
            label: "Branch A",
            backgroundColor: "red",
            data: [
               { x: new Date("2023-06-26T00:00:00"), y: 20, r: 10 },
               { x: new Date("2023-06-28T00:00:00"), y: 50, r: 15 },
            ],
            yAxisID: "y2",
         },
         {
            label: "Branch B",
            backgroundColor: "blue",
            data: [
               { x: new Date("2023-06-26T00:00:00"), y: 104, r: 5 },
               { x: new Date("2023-06-27T00:00:00"), y: 159, r: 5 },
               { x: new Date("2023-07-04T18:00:00"), y: 120, r: 5 },
            ],
            yAxisID: "y2",
         },
         {
            label: "Branch C",
            backgroundColor: "green",
            data: [
               { x: new Date("2023-06-26T00:00:00"), y: 289, r: 5 },
               { x: new Date("2023-06-27T00:00:00"), y: 210, r: 5 },
               { x: new Date("2023-07-03T20:20:00"), y: 377, r: 15 },
               { x: new Date("2023-07-05T11:11:00"), y: 377, r: 15 },
            ],
            yAxisID: "y2",
         },
         {
            label: "Branch D",
            backgroundColor: "orange",
            data: [
               { x: new Date("2023-06-26T10:30:00"), y: 333, r: 10 },
               { x: new Date("2023-07-05T22:53:00"), y: 500, r: 15 },
               { x: new Date("2023-06-26T15:00:00"), y: 389, r: 5 },
               { x: new Date("2023-06-26T10:30:00"), y: 366, r: 10 },
               { x: new Date("2023-06-28T00:00:00"), y: 310, r: 5 },
               { x: new Date("2023-06-29T00:00:00"), y: 390, r: 10 },
               { x: new Date("2023-06-30T00:00:00"), y: 430, r: 5, nested: { value: 430 } },
               { x: new Date("2023-07-01T00:00:00"), y: 366, r: 5, nested: { value: 366 } },
            ],
            yAxisID: "y2",
         },
      ],
   };

   const options = {
      plugins: {
         legend: {
            display: false,
         },
      },
      scales: {
         x: {
            type: "time",
            time: {
               unit: "day",
               displayFormats: {
                  day: "MMM dd, HH:mm",
               },
            },
            offset: true,
         },
         y: {
            type: "category",
            labels: ["Branch A", "Branch B", "Branch C", "Branch D"],
         },
         y2: {
            type: "linear",
            position: "right",
            grid: {
               drawOnChartArea: false,
            },
            offset: true,
         },
      },
   };

   onMounted(() => {
      const ctx = document.getElementById("myChart");
      new Chart(ctx, {
         type: "bubble",
         data: chartData,
         options: options,
      });
   });
</script>
